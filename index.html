<script>
    let script = document.createElement("script");
    script.src = "https://yuhncy.github.io/n8n/chat.bundle.umd.js";
    script.onload = function () {
        console.log("‚úÖ n8nChat script loaded!");

        // Ensure n8nChat is attached to the global window object
        if (typeof window.n8nChat === "undefined" && typeof n8nChat !== "undefined") {
            window.n8nChat = n8nChat;
        }

        // Retry loop to ensure n8nChat is available before calling createChat
        let attempts = 0;
        let interval = setInterval(function () {
            if (typeof window.n8nChat !== "undefined") {
                clearInterval(interval);
                console.log("üöÄ n8nChat is now available!");

                // Initialize chat
                window.n8nChat.createChat({
                    webhookUrl: "https://yancysimplyai.app.n8n.cloud/webhook/4c818c39-b9de-486f-8459-1084a4889290/chat"
                });
            } else {
                attempts++;
                console.log(`üîÑ Waiting for n8nChat... Attempt ${attempts}`);
                if (attempts > 10) {
                    clearInterval(interval);
                    console.error("‚ùå n8nChat is still undefined after multiple attempts!");
                }
            }
        }, 500);
    };

    script.onerror = function () {
        console.error("‚ùå Failed to load n8nChat script!");
    };

    document.head.appendChild(script);
</script>
